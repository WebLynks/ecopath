{% extends 'mainapp/navbar_footer.html' %}
{% load static %}

{% block title %}EcoPath - Home{% endblock %}

{% block extra_head %}
<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<style>
    /* Custom styles */
    .ecopath-card {
        will-change: flex;
    }

    .card-content {
        will-change: transform;
    }

    .heading,
    .description {
        will-change: opacity, max-width, max-height;
    }

    /* Hero Section Styles */
    .hero-slide {
        opacity: 0;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .text-shadow {
        text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.5);
    }

    .hero-dot {
        background-color: rgba(255, 255, 255, 0.3);
        transition: background-color 0.3s ease;
    }

    .hero-dot.active {
        background-color: rgba(255, 255, 255, 1);
    }

    .hero-nav-item-slot {
        display: inline-block;
    }

    .hero-nav-group {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        /* 24px */
        opacity: 0;
    }
    .no-scrollbar::-webkit-scrollbar {
        display: none; /* Chrome, Safari, Edge, Opera */
      }

    .no-scrollbar {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    }
    #slide-1 {
        background-image: url('{% static 'images/Home hero header.webp' %}');
    }
    
    @media screen and (max-width: 1024px) {
        #slide-1 {
            background-image: url('{% static 'images/Mobile version hero header.webp' %}');
        }
    }
</style>
<script>
    // Custom Tailwind configuration (merging with base if needed, but base already has it. 
    // If this page needs specific config, it might conflict or need to be after base config. 
    // Since base has the same config, we can skip re-declaring it or keep it if it has page-specifics.
    // The file had: custom-green, custom-yellow. Base has custom-green.
    // I will add custom-yellow to the config here or rely on base if I update base.
    // Let's re-declare to be safe for now, or better, just add the missing one.
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'custom-green': '#17411A',
                    'custom-yellow': '#F0ED2F',
                },
                fontFamily: {
                    'montserrat': ['Montserrat', 'sans-serif'],
                    'product-sans': ['Product Sans', 'sans-serif'],
                    'playfair-display': ['Playfair Display', 'serif']
                },
                fontSize: {
                    'sm': '14px', // 14px
                    'lg': '18px', // 18px
                    '5xl': '48px', // 48px
                }
            }
        }
    }
</script>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div id="carousel-container" class="relative w-full h-screen overflow-hidden text-white">
    <!-- Slides -->
    <div id="slide-1" class="hero-slide absolute top-[5rem] left-0 w-full h-full">
        <!-- <div class="absolute top-0 left-0 w-full h-full bg-black/40 z-10"></div> -->
        <!-- <div class="relative w-full h-full flex items-center justify-center z-20 ">
            <div class="text-center max-w-4xl p-8 mb-48">
                <h1
                    class="2xl:text-8xl xl:text-7xl text-6xl font-playfair-display font-bold mb-4 text-shadow uppercase tracking-wider text-custom-yellow">
                    ECO PATH</h1>
                <p class="text-2xl md:text-3xl text-shadow text-custom-yellow font-playfair-display">Rethinking Roads for
                    a Greener Tomorrow
                </p>
            </div>
        </div> -->
    </div>
    <div id="slide-2" class="hero-slide absolute top-[5rem] left-0 w-full h-full"
        style="background-image: url('{% static 'images/Hero image 2.webp' %}');">
        <div class="absolute top-0 left-0 w-full h-full bg-black/40 z-10"></div>
        <div class="relative w-full h-full flex items-center justify-start z-20 px-4 sm:px-24 lg:px-48">
            <div class="text-left max-w-4xl p-8 mb-48">
                <h1 class="2xl:text-6xl xl:text-5xl text-4xl font-playfair-display font-bold text-white text-shadow leading-tight">
                    Let's make green <br> construction the norm,<br> not the exception.</h1>
            </div>
        </div>
    </div>
    <div id="slide-3" class="hero-slide absolute top-[5rem] left-0 w-full h-full"
        style="background-image: url('{% static 'images/Hero image 3.webp' %}');">
        <div class="absolute top-0 left-0 w-full h-full bg-black/40 z-10 text-left"></div>
        <div class="relative w-full h-full flex items-center justify-start z-20 px-4 sm:px-24 lg:px-48">
            <div class="text-left md:max-w-4xl p-8 mb-48">
                <h1 class="2xl:text-6xl xl:text-5xl text-4xl font-playfair-display font-bold text-white text-shadow leading-tight">We
                    aim to decarbonize the construction industry and make green construction mainstream and affordable.
                </h1>
            </div>
        </div>
    </div>

    <!-- Navigation Container -->
    <div id="nav-container"
        class="absolute bottom-20 left-1/2 -translate-x-1/2 z-30 overflow-hidden bg-white/20 backdrop-blur-md rounded-xl shadow-lg px-12 py-3 min-w-[25rem] md:min-w-[40rem] 2xl:min-w-[42rem]">
        <div class="relative w-full h-full" style="height: 48px;">
            <div id="nav-group-1" class="hero-nav-group w-full">
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Road
                    Design</span>
                <span
                    class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Sustainability</span>
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Carbon
                    dioxide</span>
            </div>
            <div id="nav-group-2" class="hero-nav-group w-full">
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Water
                    saving</span>
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Eco
                    concrete</span>
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Road
                    Design</span>
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Cement
                    free</span>
            </div>
            <div id="nav-group-3" class="hero-nav-group w-full">
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Pavers</span>
                <span class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Quality</span>
                <span
                    class="hero-nav-item-slot flex-1 text-center font-montserrat font-black text-black">Sustainability</span>
            </div>
        </div>
    </div>

    <!-- Dot Indicators -->
    <div id="carousel-dots" class="absolute bottom-4 left-0 w-full z-30 flex justify-center items-center gap-3 p-4">
        <button class="hero-dot w-3 h-3 rounded-full"></button>
        <button class="hero-dot w-3 h-3 rounded-full"></button>
        <button class="hero-dot w-3 h-3 rounded-full"></button>
    </div>
</div>

<section class="mx-auto px-8 py-16 lg:h-screen flex flex-col justify-center">
    <h2 class="text-5xl font-product-sans font-black text-custom-green text-center mb-8">Why Roads Need to Change?</h2>
    <div class="flex flex-col lg:flex-row items-center gap-12">
        <!-- Image Collage -->
        <div class="w-full lg:w-1/2 h-64 flex justify-center items-center">
            <div class="relative w-[25rem] lg:w-[27.5rem] xl:w-[30rem] 2xl:w-[32.5rem] h-48">
                <!-- Image 1 -->
                <div class="absolute top-0 left-0 w-32 lg:w-40 h-48 lg:h-60 overflow-hidden group rounded-tr-[3rem] rounded-bl-[3rem]">
                    <div class="relative w-full h-full">
                        <img src="{% static 'images/roads_change(1).webp' %}" alt="High Carbon Emissions"
                            class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 p-6 py-8 flex items-end">
                            <span
                                class="text-sm font-montserrat font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">High
                                Carbon Emissions</span>
                        </div>
                    </div>
                </div>
                <!-- Image 2 -->
                <div class="absolute top-8 left-[6rem] lg:left-[6.5rem] xl:left-[7rem] 2xl:left-[7.5rem]  w-32 lg:w-40 h-48 lg:h-60 overflow-hidden z-10 group rounded-br-[3rem] rounded-tl-[3rem]">
                    <div class="relative w-full h-full">
                        <img src="{% static 'images/roads_change(2).webp' %}" alt="Road Maintenance"
                            class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 p-6 py-8 flex items-start">
                            <span
                                class="text-sm font-montserrat font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Road
                                Maintenance</span>
                        </div>
                    </div>
                </div>
                <!-- Image 3 -->
                <div class="absolute top-0 left-[12rem] lg:left-[13rem] xl:left-[14rem] 2xl:left-[15rem] w-32 lg:w-40 h-48 lg:h-60 overflow-hidden z-20 group rounded-tr-[3rem] rounded-bl-[3rem]">
                    <div class="relative w-full h-full">
                        <img src="{% static 'images/roads_change(3).webp' %}" alt="Project Delays"
                            class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 p-6 py-8 flex items-end">
                            <span
                                class="text-sm font-montserrat font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Project
                                Delays</span>
                        </div>
                    </div>
                </div>
                <!-- Image 4 -->
                <div class="absolute top-8 left-[18rem] lg:left-[19.5rem] xl:left-[21rem] 2xl:left-[22.5rem] h-48 lg:h-60 w-32 lg:w-40 overflow-hidden z-20 group rounded-br-[3rem] rounded-tl-[3rem]">
                    <div class="relative w-full h-full">
                        <img src="{% static 'images/roads_change(4).webp' %}" alt="Rising Costs"
                            class="w-full h-full object-cover">
                        <div
                            class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 p-6 py-8 flex items-start">
                            <span
                                class="text-sm font-montserrat font-medium text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">Rising
                                Costs</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Text Content -->
        <div class="w-full lg:w-1/2">
            <p class="text-lg text-gray-700 font-montserrat leading-relaxed">
                Traditional road construction comes with a heavy price — high carbon emissions, constant maintenance,
                rising costs, and endless delays. These challenges not only strain the environment but also slow down
                progress and drain valuable resources. At EcoPath, we set out to change this by rethinking how roads are
                built — faster, greener, and more sustainable for the future.
            </p>
        </div>
    </div>
</section>

<!-- We at EcoPath Section -->
<section class="py-16 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
        <h2 class="text-5xl font-product-sans font-black text-custom-green text-center mb-12 md:mb-16">
            We at EcoPath
        </h2>

        <div id="cards-container"
            class="flex flex-col md:flex-row w-full h-[100vh] md:h-[70vh] rounded-lg overflow-hidden shadow-2xl bg-white gap-y-3 md:gap-y-0 md:gap-x-3">
            <!-- Card 1 -->
            <div class="card flex-1 relative bg-cover bg-center cursor-pointer overflow-hidden group"
                style="background-image: url('{% static 'images/we_at_ecopath (1).webp' %}');">
                <div class="absolute inset-0 bg-black/30 transition-opacity duration-500 group-hover:bg-black/50"></div>

                <!-- Header Group: Number + Title -->
                <div class="header-group absolute flex items-center z-20">
                    <span class="number text-6xl md:text-8xl lg:text-9xl font-black text-white/90 leading-none">1</span>
                    <h2
                        class="heading text-xl md:text-2xl lg:text-3xl font-bold uppercase text-white ml-4 whitespace-nowrap overflow-hidden opacity-0 w-0">
                        Build Roads
                    </h2>
                </div>

                <!-- Description -->
                <p
                    class="description absolute text-base text-xl md:text-2xl text-white/90 w-full text-center z-10 opacity-0 px-4">
                    We stabilize the soil you already have — no soil is imported, engineering road design for better
                    durability and build roads for life long longevity.
                </p>
            </div>

            <!-- Card 2 -->
            <div class="card flex-1 relative bg-cover bg-center cursor-pointer overflow-hidden group"
                style="background-image: url('{% static 'images/we_at_ecopath (2).webp' %}');">
                <div class="absolute inset-0 bg-black/30 transition-opacity duration-500 group-hover:bg-black/50"></div>

                <div class="header-group absolute flex items-center z-20">
                    <span class="number text-6xl md:text-8xl lg:text-9xl font-black text-white/90 leading-none">2</span>
                    <h2
                        class="heading text-xl md:text-2xl lg:text-3xl font-bold uppercase text-white ml-4 whitespace-nowrap overflow-hidden opacity-0 w-0">
                        Sustainable Solutions
                    </h2>
                </div>

                <p
                    class="description absolute text-base text-xl md:text-2xl text-white/90 w-full text-center z-10 opacity-0 px-4">
                    Our innovative approach reduces carbon footprint and environmental impact while delivering
                    high-quality, long-lasting road infrastructure.
                </p>
            </div>

            <!-- Card 3 -->
            <div class="card flex-1 relative bg-cover bg-center cursor-pointer overflow-hidden group"
                style="background-image: url('{% static 'images/we_at_ecopath (3).webp' %}');">
                <div class="absolute inset-0 bg-black/30 transition-opacity duration-500 group-hover:bg-black/50"></div>

                <div class="header-group absolute flex items-center z-20">
                    <span class="number text-6xl md:text-8xl lg:text-9xl font-black text-white/90 leading-none">3</span>
                    <h2
                        class="heading text-xl md:text-2xl lg:text-3xl font-bold uppercase text-white ml-4 whitespace-nowrap overflow-hidden opacity-0 w-0">
                        Future Ready
                    </h2>
                </div>

                <p
                    class="description absolute text-base text-xl md:text-2xl text-white/90 w-full text-center z-10 opacity-0 px-4">
                    Pioneering the next generation of road construction with cutting-edge technology and sustainable
                    practices for a better tomorrow.
                </p>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const cards = gsap.utils.toArray('.card');
        const container = document.getElementById('cards-container');
        let activeCard = null;
        let mm = gsap.matchMedia();

        // --- COMMON SETUP ---
        const setupCards = () => {
            cards.forEach(card => {
                const headerGroup = card.querySelector('.header-group');
                const description = card.querySelector('.description');
                const heading = card.querySelector('.heading');

                gsap.set(headerGroup, {
                    top: '50%',
                    left: '50%',
                    xPercent: -50,
                    yPercent: -50
                });

                gsap.set(description, {
                    top: '60%',
                    left: '50%',
                    xPercent: -50,
                    yPercent: -30,
                    opacity: 0
                });

                gsap.set(heading, { width: 0, opacity: 0 });
            });
        };

        // --- ANIMATION LOGIC ---

        mm.add("(min-width: 768px)", () => {
            // DESKTOP: Horizontal Flex
            setupCards();

            const animateInDesktop = (card) => {
                const headerGroup = card.querySelector('.header-group');
                const description = card.querySelector('.description');
                const heading = card.querySelector('.heading');
                const tl = gsap.timeline({ defaults: { duration: 0.6, ease: 'power3.inOut' } });

                tl.to(card, { flex: 5 }, 0);
                tl.to(headerGroup, { top: '.5rem', left: '2rem', xPercent: 0, yPercent: 0 }, 0);
                tl.to(heading, { width: 'auto', opacity: 1, marginLeft: '1rem' }, 0);
                tl.to(description, { top: '50%', opacity: 1 }, 0);
                return tl;
            };

            const animateOutDesktop = (card) => {
                const headerGroup = card.querySelector('.header-group');
                const description = card.querySelector('.description');
                const heading = card.querySelector('.heading');
                const tl = gsap.timeline({ defaults: { duration: 0.5, ease: 'power3.inOut' } });

                tl.to(card, { flex: 1 }, 0);
                tl.to(headerGroup, { top: '50%', left: '50%', xPercent: -50, yPercent: -30 }, 0);
                tl.to(heading, { width: 0, opacity: 0, marginLeft: 0 }, 0);
                tl.to(description, { top: '60%', opacity: 0 }, 0);
                return tl;
            };

            // Event Listeners for Desktop
            cards.forEach(card => {
                card.onmouseenter = () => {
                    if (activeCard === card) return;
                    if (activeCard) animateOutDesktop(activeCard);
                    activeCard = card;
                    animateInDesktop(card);
                };
            });

            container.onmouseleave = () => {
                if (activeCard) {
                    animateOutDesktop(activeCard);
                    activeCard = null;
                }
            };

            return () => {
                // Cleanup
                cards.forEach(c => c.onmouseenter = null);
                container.onmouseleave = null;
            };
        });

        mm.add("(max-width: 767px)", () => {
            // MOBILE: Vertical Flex
            setupCards();

            const animateInMobile = (card) => {
                const headerGroup = card.querySelector('.header-group');
                const description = card.querySelector('.description');
                const heading = card.querySelector('.heading');
                const tl = gsap.timeline({ defaults: { duration: 0.6, ease: 'power3.inOut' } });

                // Animate flex-grow for vertical expansion
                tl.to(card, { flex: 3 }, 0);

                // Move Number to Top Left (adjusted for smaller screens)
                tl.to(headerGroup, { top: '2rem', left: '2rem', xPercent: 0, yPercent: 0 }, 0);

                tl.to(heading, { width: 'auto', opacity: 1, marginLeft: '0.5rem' }, 0);
                tl.to(description, { top: '55%', opacity: 1 }, 0);
                return tl;
            };

            const animateOutMobile = (card) => {
                const headerGroup = card.querySelector('.header-group');
                const description = card.querySelector('.description');
                const heading = card.querySelector('.heading');
                const tl = gsap.timeline({ defaults: { duration: 0.5, ease: 'power3.inOut' } });

                tl.to(card, { flex: 1 }, 0);
                tl.to(headerGroup, { top: '50%', left: '50%', xPercent: -50, yPercent: -30 }, 0);
                tl.to(heading, { width: 0, opacity: 0, marginLeft: 0 }, 0);
                tl.to(description, { top: '60%', opacity: 0 }, 0);
                return tl;
            };

            // Event Listeners for Mobile (Click instead of Hover usually better, but keeping hover logic for consistency if requested, 
            // though click is standard for mobile accordions. Using click here for better UX)
            cards.forEach(card => {
                card.onclick = () => {
                    if (activeCard === card) {
                        // Toggle off if clicking active
                        animateOutMobile(activeCard);
                        activeCard = null;
                    } else {
                        if (activeCard) animateOutMobile(activeCard);
                        activeCard = card;
                        animateInMobile(card);
                    }
                };
            });

            return () => {
                cards.forEach(c => c.onclick = null);
            };
        });
    });
</script>

<!-- Drain Animation Section -->
<section class="py-16 px-4 sm:px-6 lg:px-8 bg-[#E6E6DF]">
    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-8 md:gap-16">
            <!-- Content Column (Left on large screens) -->
            <div class="md:w-1/2">
                <h2 class="text-4xl font-product-sans font-black text-custom-green mb-4">
                    Entire ROAD INFRA DEVELOPMENT under one roof
                </h2>
                <p class="text-lg font-montserrat mb-12 max-w-3xl">
                    The biggest pain point for delays & losses is multiple vendors & lack of coordination.
                    Eco Path takes care of everything. All concrete products without using cement.
                </p>

                <!-- Navigation List -->
                <div class="flex justify-center lg:justify-start">
                    <ul id="infra-nav" class="relative space-y-4 w-full max-w-xs">
                        <!-- Active Item Indicator Bar -->
                        <li id="active-bar"
                            class="absolute left-0 w-1 h-6 bg-custom-green transition-all duration-200 ease-in-out"
                            style="top: 0px;"></li>

                        <!-- List Items -->
                        <li class="nav-item text-lg font-product-sans font-black text-gray-800 pl-6 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="1">
                            Drain
                        </li>
                        <li class="nav-item text-lg font-product-sans font-black text-gray-800 pl-6 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="2">
                            Footpath
                        </li>
                        <li class="nav-item text-lg font-product-sans font-black text-gray-800 pl-6 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="3">
                            Sewer Line
                        </li>
                        <li class="nav-item text-lg font-product-sans font-black text-gray-800 pl-6 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="4">
                            Electricity Lines
                        </li>
                        <li class="nav-item text-lg font-product-sans font-black text-gray-800 pl-6 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="5">
                            Street Lights
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Image Stack (Right on large screens) -->
            <div class="w-full md:w-1/2 lg:h-[40rem] h-[25rem] flex items-center justify-center mt-8 md:mt-0">
                <!-- Added 'relative' here to ensure absolute children position correctly relative to this container -->
                <div class="image-stack-container w-full h-full relative mx-10 my-10">
                    <img src="{% static 'images/Drain.webp' %}" alt="Drain"
                        class="image-card data-[index='0'] absolute 2xl:w-2/3 xl:w-3/5 w-2/4 h-auto rounded-2xl" data-index="1">
                    <img src="{% static 'images/Footpath.webp' %}" alt="Footpath"
                        class="image-card data-[index='1'] absolute 2xl:w-2/3 xl:w-3/5 w-2/4 h-auto rounded-2xl" data-index="2">
                    <img src="{% static 'images/Sewer Line.webp' %}" alt="Sewer Line"
                        class="image-card data-[index='2'] absolute 2xl:w-2/3 xl:w-3/5 w-2/4 h-auto rounded-2xl" data-index="3">
                    <img src="{% static 'images/Electricity Lines.webp' %}" alt="Electricity Lines"
                        class="image-card data-[index='3'] absolute 2xl:w-2/3 xl:w-3/5 w-2/4 h-auto rounded-2xl" data-index="4">
                    <img src="{% static 'images/Street Lights.webp' %}" alt="Street Lights"
                        class="image-card data-[index='4'] absolute 2xl:w-2/3 xl:w-3/5 w-2/4 h-auto rounded-2xl" data-index="5">
                </div>
            </div>
        </div>
    </div>
</section>fa

<script>
    // Drain Animation Script
    document.addEventListener('DOMContentLoaded', () => {
        const navItems = gsap.utils.toArray('.nav-item');
        const imageCards = gsap.utils.toArray('.image-card');
        const activeBar = document.getElementById('active-bar');

        let activeIndex = 0; // Default active item

        // Base Y position for the active card (pushes it to the bottom)
        // 60% allows enough room above for the other cards to stack up without clipping
        const ACTIVE_Y_BASE = 60; 

        const animProps = {
            duration: 0.7,
            ease: 'power3.inOut'
        };

        // Function to update the image stack based on the active index
        function updateActiveState(newIndex) {
            if (newIndex === activeIndex) return; // Do nothing if already active

            // Update active nav item styles
            navItems[activeIndex].classList.remove('text-custom-green');
            navItems[newIndex].classList.add('text-custom-green');

            activeIndex = newIndex;

            // Update Active Bar Immediately
            const activeNavItem = navItems[activeIndex];
            gsap.set(activeBar, {
                top: activeNavItem.offsetTop,
                height: activeNavItem.offsetHeight
            });

            // Apply subtle animation for visual feedback
            gsap.fromTo(activeBar,
                { scaleY: 0.8, opacity: 0.7 },
                {
                    scaleY: 1,
                    opacity: 1,
                    duration: 0.2,
                    ease: 'power2.out'
                }
            );

            // Animate Image Stack
            imageCards.forEach((card, index) => {
                const stackPosition = index - activeIndex;
                const stackPositionAbs = Math.abs(stackPosition);

                if (stackPosition === 0) {
                    // Animate TO Active State (Bottom, Front)
                    gsap.to(card, {
                        zIndex: 10,
                        x: '0%',
                        y: ACTIVE_Y_BASE + '%', // Move to bottom
                        z: 0,
                        rotate: '0deg',
                        scale: 1,
                        ...animProps
                    });
                } else {
                    // Animate TO Inactive State (Staircase Up and Right)
                    gsap.to(card, {
                        zIndex: 5 - stackPositionAbs,
                        x: (stackPositionAbs * 15) + '%', // Move Right
                        y: (ACTIVE_Y_BASE - (stackPositionAbs * 15)) + '%', // Move Up relative to base
                        z: -(stackPositionAbs * 150),
                        scale: 1,
                        ...animProps
                    });
                }
            });
        }

        // Set Initial State
        function setInitialState() {
            // Set bar to first item
            gsap.set(activeBar, {
                top: navItems[0].offsetTop,
                height: navItems[0].offsetHeight
            });

            // Set initial card positions
            imageCards.forEach((card, index) => {
                const stackPosition = index - activeIndex;
                const stackPositionAbs = Math.abs(stackPosition);

                if (stackPosition === 0) {
                    gsap.set(card, {
                        zIndex: 10, 
                        x: '0%', 
                        y: ACTIVE_Y_BASE + '%', // Move to bottom
                        z: 0, 
                        rotate: '0deg', 
                        scale: 1
                    });
                } else {
                    gsap.set(card, {
                        zIndex: 5 - stackPositionAbs,
                        x: (stackPositionAbs * 15) + '%',
                        y: (ACTIVE_Y_BASE - (stackPositionAbs * 15)) + '%', // Move Up
                        z: -(stackPositionAbs * 150),
                        scale: 1
                    });
                }
            });
        }

        // Add Event Listeners
        navItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                updateActiveState(index);
            });
        });

        // Initialize the component
        setInitialState();

        // Set first nav item as active
        navItems[0].classList.add('text-custom-green');
    });
</script>

<!-- Eco Concrete Section -->
<section class="p-8 sm:p-12 md:p-16 flex items-center justify-center">
    <div class="relative w-full lg:w-[80%]  mx-auto">
        <img src="{% static 'images/Eco Concrete Intro Frame.webp' %}" alt="Eco Concrete blocks stacked"
            class="w-full h-auto rounded-xl block">
        <!-- <div class="absolute bottom-8 left-8 sm:bottom-12 sm:left-12 md:bottom-16 md:left-16">
            <a href="#"
                class="group inline-flex items-center gap-x-3 px-6 py-3 border border-custom-green bg-white/70 backdrop-blur-sm rounded-md font-montserrat text-base text-custom-green transition-all duration-300 hover:bg-custom-green hover:border-green-400 hover:text-white">
                KNOW MORE
                <svg class="w-4 h-4 transition-transform duration-300 group-hover:translate-x-1" fill="none"
                    stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3">
                    </path>
                </svg>
            </a>
        </div> -->
    </div>
</section>

<!-- GoKart Project Section -->
<section class="lg:h-screen w-full">
    <img src="{% static 'images/Project banner.webp' %}" alt="GoKart Project" class="w-full h-full object-cover">
</section>

<!-- Clientele Section -->
<section class="lg:min-h-screen w-100 py-10 md:px-10">
    <div class="w-full h-full bg-[#E6E6DF] py-16 sm:py-24 px-4 sm:px-6 lg:px-8">
        <!-- Top Part: Title + Testimonials -->
        <div class="flex flex-col lg:flex-row gap-12 lg:gap-8">
            <div class="lg:w-1/3 text-center lg:text-left">
                <p class="font-montserrat text-custom-green font-semibold">CLIENTELE</p>
                <h2 class="text-4xl sm:text-5xl font-product-sans font-black text-custom-green mt-2">What people say
                    about us?</h2>
            </div>
            <div class="lg:w-2/3 relative overflow-y-auto no-scrollbar">
                <div class="flex gap-8 flex-nowrap">
                    <div class="testimonial-card flex-shrink-0 w-[90%] sm:w-[380px] bg-white p-8 rounded-2xl shadow-md">
                        <div class="flex items-start gap-4">
                            <img src="{% static 'images/nagrag.webp' %}" alt="Nagraj"
                                class="w-14 h-14 rounded-full object-cover">
                            <div>
                                <h3 class="font-product-sans font-bold text-lg">Nagraj</h3>
                                <p class="font-montserrat text-sm text-gray-600">Owner Forest by the Hills</p>
                            </div>
                        </div>
                        <p class="font-montserrat text-gray-700 mt-4">
                            "I couldn't be happier with the work Eco Path did for Forest by The Hills in Karjat. We had
                            serious issues with the existing road, but their team came in with innovative solutions and
                            tackled every challenge head-on."
                        </p>
                    </div>
                    <div class="testimonial-card flex-shrink-0 w-[90%] sm:w-[380px] bg-white p-8 rounded-2xl shadow-md">
                        <div class="flex items-start gap-4">
                            <img src="{% static 'images/nagrag.webp' %}" alt="Nagraj"
                                class="w-14 h-14 rounded-full object-cover">
                            <div>
                                <h3 class="font-product-sans font-bold text-lg">Nagraj</h3>
                                <p class="font-montserrat text-sm text-gray-600">Owner Forest by the Hills</p>
                            </div>
                        </div>
                        <p class="font-montserrat text-gray-700 mt-4">
                            "The new road is not only durable but also environmentally friendly. Their professionalism
                            and commitment to quality are truly commendable. Highly recommended!"
                        </p>
                    </div>
                    <div class="testimonial-card flex-shrink-0 w-[90%] sm:w-[380px] bg-white p-8 rounded-2xl shadow-md">
                        <div class="flex items-start gap-4">
                            <img src="{% static 'images/nagrag.webp' %}" alt="Nagraj"
                                class="w-14 h-14 rounded-full object-cover">
                            <div>
                                <h3 class="font-product-sans font-bold text-lg">Nagraj</h3>
                                <p class="font-montserrat text-sm text-gray-600">Owner Forest by the Hills</p>
                            </div>
                        </div>
                        <p class="font-montserrat text-gray-700 mt-4">
                            "I couldn't be happier with the work Eco Path did for Forest by The Hills in Karjat. We had
                            serious issues with the existing road, but their team came in with innovative solutions and
                            tackled every challenge head-on."
                        </p>
                    </div>
                    <div class="testimonial-card flex-shrink-0 w-[90%] sm:w-[380px] bg-white p-8 rounded-2xl shadow-md">
                        <div class="flex items-start gap-4">
                            <img src="{% static 'images/nagrag.webp' %}" alt="Nagraj"
                                class="w-14 h-14 rounded-full object-cover">
                            <div>
                                <h3 class="font-product-sans font-bold text-lg">Nagraj</h3>
                                <p class="font-montserrat text-sm text-gray-600">Owner Forest by the Hills</p>
                            </div>
                        </div>
                        <p class="font-montserrat text-gray-700 mt-4">
                            "I couldn't be happier with the work Eco Path did for Forest by The Hills in Karjat. We had
                            serious issues with the existing road, but their team came in with innovative solutions and
                            tackled every challenge head-on."
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Part: Client Logos -->
        <div class="mt-24 relative overflow-hidden h-20">
            <div class="client-logo-scroller w-max flex items-center h-full gap-x-16 sm:gap-x-24">
                <img src="{% static 'images/client (1).webp' %}" class="client-logo h-12 sm:h-14 w-auto object-contain"
                    alt="Client Logo 1">
                <img src="{% static 'images/client (2).webp' %}" class="client-logo h-14 sm:h-16 w-auto object-contain"
                    alt="Client Logo 2">
                <img src="{% static 'images/client (3).webp' %}" class="client-logo h-10 sm:h-12 w-auto object-contain"
                    alt="Client Logo 3">
                <img src="{% static 'images/client (4).webp' %}" class="client-logo h-16 sm:h-20 w-auto object-contain"
                    alt="Client Logo 4">
                <img src="{% static 'images/client (5).webp' %}" class="client-logo h-12 sm:h-14 w-auto object-contain"
                    alt="Client Logo 5">
                <img src="{% static 'images/client (6).webp' %}" class="client-logo h-14 sm:h-16 w-auto object-contain"
                    alt="Client Logo 6">
                <img src="{% static 'images/client (7).webp' %}" class="client-logo h-10 sm:h-12 w-auto object-contain"
                    alt="Client Logo 7">
                <img src="{% static 'images/client (8).webp' %}" class="client-logo h-16 sm:h-20 w-auto object-contain"
                    alt="Client Logo 8">
                <img src="{% static 'images/client (9).webp' %}" class="client-logo h-12 sm:h-14 w-auto object-contain"
                    alt="Client Logo 9">
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        function createInfiniteScroller(scrollerSelector, itemsSelector, duration, isVertical = false) {
            const scroller = document.querySelector(scrollerSelector);
            if (!scroller) return;

            const items = Array.from(scroller.querySelectorAll(itemsSelector));
            items.forEach(item => scroller.appendChild(item.cloneNode(true)));

            const scrollerWidth = items.reduce((acc, item) => acc + item.offsetWidth + parseInt(getComputedStyle(item).marginRight || 0), 0);

            gsap.to(scroller, {
                x: -scrollerWidth,
                duration: duration,
                ease: 'none',
                repeat: -1,
            });
        }

        createInfiniteScroller('.client-logo-scroller', '.client-logo', 50);

        // Hero Section Animation Logic
        const slides = gsap.utils.toArray(".hero-slide");
        const dots = gsap.utils.toArray(".hero-dot");
        const navGroups = gsap.utils.toArray(".hero-nav-group");
        const totalSlides = slides.length;
        let currentSlide = 0;
        let slideInterval;
        const slideDuration = 4000;
        const fadeDuration = 1;

        function updateIndicators() {
            dots.forEach((dot, index) => {
                dot.classList.toggle("active", index === currentSlide);
            });
        }

        function animateSlides(oldSlideIndex, newSlideIndex) {
            gsap.to(slides[oldSlideIndex], {
                opacity: 0,
                duration: fadeDuration,
                ease: "power1.inOut"
            });
            gsap.to(slides[newSlideIndex], {
                opacity: 1,
                duration: fadeDuration,
                ease: "power1.inOut"
            });

            const oldGroup = navGroups[oldSlideIndex];
            const newGroup = navGroups[newSlideIndex];
            const oldItems = oldGroup.children;
            const newItems = newGroup.children;

            gsap.set(newGroup, { opacity: 1 });

            gsap.to(oldItems, {
                opacity: 0,
                yPercent: () => (Math.random() > 0.5 ? 100 : -100),
                stagger: 0.05,
                duration: fadeDuration * 0.5,
                ease: "power2.in",
                onComplete: () => {
                    gsap.set(oldGroup, { opacity: 0 });
                }
            });

            gsap.fromTo(newItems,
                {
                    opacity: 0,
                    yPercent: () => (Math.random() > 0.5 ? 100 : -100)
                },
                {
                    opacity: 1, // Changed to 1 for black text
                    yPercent: 0,
                    stagger: 0.05,
                    duration: fadeDuration,
                    delay: fadeDuration * 0.2,
                    ease: "power2.out"
                }
            );
        }

        function showNextSlide() {
            const oldSlideIndex = currentSlide;
            currentSlide = (currentSlide + 1) % totalSlides;
            animateSlides(oldSlideIndex, currentSlide);
            updateIndicators();
        }

        function goToSlide(index) {
            if (index === currentSlide) return;
            const oldSlideIndex = currentSlide;
            currentSlide = index;
            animateSlides(oldSlideIndex, currentSlide);
            updateIndicators();
            clearInterval(slideInterval);
            slideInterval = setInterval(showNextSlide, slideDuration);
        }

        gsap.set(slides[currentSlide], { opacity: 1 });
        updateIndicators();

        navGroups.forEach((group, index) => {
            const items = group.children;
            if (index === currentSlide) {
                gsap.set(group, { opacity: 1 });
                gsap.set(items, { opacity: 1, yPercent: 0 }); // Changed to 1 for black text
            } else {
                gsap.set(group, { opacity: 0 });
                gsap.set(items, { opacity: 0, yPercent: 100 });
            }
        });

        dots.forEach((dot, index) => {
            dot.addEventListener("click", () => {
                goToSlide(index);
            });
        });

        slideInterval = setInterval(showNextSlide, slideDuration);
    });    
</script>
{% endblock %}