{% extends 'mainapp/navbar_footer.html' %}
{% load static %}

{% block title %}Our Services - EcoPath{% endblock %}

{% block extra_head %}
<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
    /* Custom styles */
    .ecopath-card {
        will-change: flex;
    }

    .card-content {
        will-change: transform;
    }

    .heading,
    .description {
        will-change: opacity, max-width, max-height;
    }

    /* Hero Section Styles */
    .hero-slide {
        opacity: 0;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .text-shadow {
        text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.5);
    }

    .hero-dot {
        background-color: rgba(255, 255, 255, 0.3);
        transition: background-color 0.3s ease;
    }

    .hero-dot.active {
        background-color: rgba(255, 255, 255, 1);
    }

    .hero-nav-item-slot {
        display: inline-block;
    }

    .hero-nav-group {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        /* 24px */
        opacity: 0;
    }
</style>
<!-- <script>
    // Custom Tailwind configuration
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'custom-green': '#17411A',
                    'custom-yellow': '#F0ED2F',
                    'card-bg-green': '#CAEACC'
                },
                fontFamily: {
                    'montserrat': ['Montserrat', 'sans-serif'],
                    'product-sans': ['Product Sans', 'sans-serif'],
                    'playfair-display': ['Playfair Display', 'serif']
                },
                fontSize: {
                    'sm': '14px', // 14px
                    'lg': '18px', // 18px
                    '5xl': '48px', // 48px
                }
            }
        }
    }
</script> -->
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative h-screen w-full bg-cover bg-center text-white sm:p-4 pt-16 lg:p-12 lg:px-12 lg:pt-24"
    style="background-image: url('{% static 'images/Services Hero Header image.webp' %}');">
    <div class="absolute inset-0 bg-black/40"></div>
    <div class="relative h-full flex flex-col justify-center p-4 lg:px-8">
        <h1 class="text-4xl lg:text-5xl xl:text-6xl 2xl:text-7xl font-product-sans font-black uppercase mb-10">
            Our Services
        </h1>
        <p class="text-4xl md:text-6xl font-playfair-display max-w-4xl leading-tight">
            Sustainable road solutions: Carbon-negative, end-to-end, and design-led.
        </p>
    </div>
</section>

<!-- Maintenance Section -->
<section class="py-8 md:py-24 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto">
        <div class="flex flex-col md:flex-row lg:mx-12 gap-8">
            <!-- Text Column -->
            <div class="w-full md:w-1/2 py-6 items-end">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-product-sans font-black text-custom-green py-8">
                    End to End Road Design
                </h2>
                <p class="font-montserrat text-lg text-gray-700 leading-relaxed">
                    Our maintenance services are designed to extend the lifespan of your infrastructure while
                    minimizing environmental impact. Using sustainable materials and eco-friendly techniques, we
                    ensure your roads remain in optimal condition with minimal carbon footprint.
                </p>
            </div>

            <!-- Image Column -->
            <div class="w-full md:w-1/2 flex justify-end">
                <img src="{% static 'images/End to end image.webp' %}" alt="Maintenance Services"
                    class="w-full h-auto max-h-[80vh] object-contain">
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="min-h-screen bg-[#E6E6DF] py-16 md:py-24 px-4 sm:px-6 lg:px-8 flex items-center">
    <div class="container mx-auto">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-product-sans font-black text-center mb-16 text-custom-green">
            We specialize in</h2>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-16 max-w-6xl mx-auto items-start">
            <!-- Feature 1 -->
            <div class="h-full flex flex-col items-center text-center">
                <div class="p-8 rounded-2xl shadow-sm w-full h-full flex flex-col items-center">
                    <img src="{% static 'images/cell 1.webp' %}" alt="Planning" class="w-24 h-24 mb-6">
                    <p class="font-montserrat text-lg text-gray-700">Soil stabilization for subgrade strengthening.
                    </p>
                </div>
            </div>

            <!-- Feature 2 -->
            <div class="h-full flex flex-col items-center text-center">
                <div class="p-8 rounded-2xl shadow-sm w-full h-full flex flex-col items-center">
                    <img src="{% static 'images/plant 1.webp' %}" alt="Eco-Friendly" class="w-24 h-24 mb-6">
                    <p class="font-montserrat text-lg text-gray-700">Geo-cell reinforcement for extreme soil
                        conditions.</p>
                </div>
            </div>

            <!-- Feature 3 -->
            <div class="h-full flex flex-col items-center text-center">
                <div class="p-8 rounded-2xl shadow-sm w-full h-full flex flex-col items-center">
                    <img src="{% static 'images/road-with-broken-line 1.webp' %}" alt="Implementation"
                        class="w-24 h-24 mb-6">
                    <p class="font-montserrat text-lg text-gray-700">Precision design, delivering unbreakable,
                        long-lasting roads.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Services Overview Section -->
<section class="py-16 md:py-24 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-product-sans font-black py-8 text-custom-green">
            Traction & Milestones
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6">
            <!-- Service Card 1 -->
            <div
                class="bg-card-bg-green rounded-xl px-6 py-24 lg:py-32 shadow-md flex flex-col items-center justify-center text-center">
                <h3 class="text-3xl md:text-4xl font-product-sans font-black py-6">$ 300K</h3>
                <p class="font-montserrat text-lg text-grey-800">
                    revenue generated in FY25
                </p>
            </div>

            <!-- Service Card 2 -->
            <div
                class="bg-card-bg-green rounded-xl p-6 py-24 lg:py-32 shadow-md flex flex-col items-center justify-center text-center">
                <h3 class="text-3xl md:text-4xl font-product-sans font-black py-6">$ 1M+</h3>
                <p class="font-montserrat text-lg text-grey-800">
                    signed PO's with real estate developers.
                </p>
            </div>

            <!-- Service Card 3 -->
            <div
                class="bg-card-bg-green rounded-xl p-6 py-24 lg:py-32 shadow-md  flex flex-col items-center justify-center text-center">
                <h3 class="text-3xl md:text-4xl font-product-sans font-black py-6">4</h3>
                <p class="font-montserrat text-lg text-grey-800">
                    manufacturing partners in Bangalore.
                </p>
            </div>

            <!-- Service Card 4 -->
            <div
                class="bg-card-bg-green rounded-xl p-6 py-24 lg:py-32 shadow-md flex flex-col items-center justify-center text-center">
                <h3 class="text-3xl md:text-4xl font-product-sans font-black py-6">R&D</h3>
                <p class="font-montserrat text-lg text-grey-800">
                    Filed 2 Process & 1 Design Patent for Eco-Concrete.
                </p>
            </div>
        </div>
    </div>
</section>

<section class="py-16 md:py-24 px-4 sm:px-6 lg:px-8 bg-[#E6E6DF]">
    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row md:justify-between gap-8 md:gap-16">
            <div class="md:w-1/2 flex justify-start flex-col">
                <h2 class="text-3xl md:text-4xl lg:text-5xl font-product-sans font-black text-custom-green py-8">
                    Road Construction
                </h2>

                <div class="flex justify-start">
                    <ul id="infra-nav" class="relative space-y-4 w-full max-w-sm md:max-w-lg">
                        <li id="active-bar"
                            class="absolute left-0 w-1 h-6 bg-custom-green transition-all duration-200 ease-in-out"
                            style="top: 0px;"></li>

                        <li class="nav-item leading-tight text-xl font-product-sans font-black  pl-6 py-2 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="0">
                            Carbon Negative Bitumen Roads
                        </li>
                        <li class="nav-item leading-tight text-xl font-product-sans font-black  pl-6 py-2 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="1">
                            Precast Concrete Roads
                        </li>
                        <li class="nav-item leading-tight text-xl font-product-sans font-black  pl-6 py-2 cursor-pointer transition-colors duration-200 hover:text-custom-green"
                            data-index="2">
                            Paver Based Roads for Villas & Resorts
                        </li>
                    </ul>
                </div>

                <div class="text-content-container relative mt-6 lg:mt-12 max-w-3xl h-16 mb-8">
                    <p class="nav-text-content absolute top-0 left-0 w-full text-lg font-montserrat text-custom-green" data-index="0">
                        <i>The biggest pain point for delays & losses is multiple vendors & lack of coordination.
                        Eco Path takes care of everything. All concrete products without using cement.</i>
                    </p>
                    <p class="nav-text-content absolute top-0 left-0 w-full text-lg font-montserrat text-custom-green opacity-0" data-index="1">
                        <i>Precast concrete roads offer faster installation and superior durability compared to traditional methods. Our process ensures minimal on-site disruption.</i>
                    </p>
                    <p class="nav-text-content absolute top-0 left-0 w-full text-lg font-montserrat text-custom-green opacity-0" data-index="2">
                        <i>For private developments like villas and resorts, paver-based roads provide an aesthetic, permeable, and easily repairable solution, blending seamlessly with the environment.</i>
                    </p>
                </div>
            </div>

            <div class="w-full md:w-1/2 2xl:h-[25rem] h-[20rem] lg:h-[18rem] flex items-center justify-center mt-20 md:mt-0">
                <div class="image-stack-container w-full h-full relative mx-10 my-10">
                    <img src="{% static 'images/Drain.webp' %}" alt="Drain"
                        class="image-card data-[index='0'] absolute w-4/5 lg:w-3/5 h-auto rounded-2xl" data-index="0">
                    <img src="{% static 'images/Footpath.webp' %}" alt="Footpath"
                        class="image-card data-[index='1'] absolute w-4/5 lg:w-3/5 h-auto rounded-2xl" data-index="1">
                    <img src="{% static 'images/Sewer Line.webp' %}" alt="Sewer Line"
                        class="image-card data-[index='2'] absolute w-4/5 lg:w-3/5 h-auto rounded-2xl" data-index="2">
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    // Drain Animation Script
    document.addEventListener('DOMContentLoaded', () => {
        const navItems = gsap.utils.toArray('.nav-item');
        const imageCards = gsap.utils.toArray('.image-card');
        const textContents = gsap.utils.toArray('.nav-text-content'); // Get the new text elements
        const activeBar = document.getElementById('active-bar');

        let activeIndex = 0; // Default active item

        // Base Y position for the active card (pushes it to the bottom)
        // 60% allows enough room above for the other cards to stack up without clipping
        const ACTIVE_Y_BASE = 30; 

        const animProps = {
            duration: 0.7,
            ease: 'power3.inOut'
        };

        // Function to update the image stack and text content based on the active index
        function updateActiveState(newIndex) {
            if (newIndex === activeIndex) return; // Do nothing if already active

            // 1. Fade Out Old Text
            gsap.to(textContents[activeIndex], {
                opacity: 0,
                duration: 0.3,
                ease: 'power1.out',
                zIndex: 1 // Lower zIndex for fading out element
            });

            // Update active nav item styles
            navItems[activeIndex].classList.remove('text-custom-green');
            navItems[newIndex].classList.add('text-custom-green');

            activeIndex = newIndex;

            // 2. Update Active Bar Immediately
            const activeNavItem = navItems[activeIndex];
            gsap.set(activeBar, {
                top: activeNavItem.offsetTop,
                height: activeNavItem.offsetHeight
            });

            // Apply subtle animation for visual feedback
            gsap.fromTo(activeBar,
                { scaleY: 0.8, opacity: 0.7 },
                {
                    scaleY: 1,
                    opacity: 1,
                    duration: 0.2,
                    ease: 'power2.out'
                }
            );

            // 3. Animate Image Stack (Existing logic, slightly modified to ensure zIndex is updated)
            imageCards.forEach((card, index) => {
                const stackPosition = index - activeIndex;
                const stackPositionAbs = Math.abs(stackPosition);

                if (stackPosition === 0) {
                    // Animate TO Active State (Bottom, Front)
                    gsap.to(card, {
                        zIndex: 10,
                        x: '0%',
                        y: ACTIVE_Y_BASE + '%', // Move to bottom
                        z: 0,
                        rotate: '0deg',
                        scale: 1,
                        ...animProps
                    });
                } else {
                    // Animate TO Inactive State (Staircase Up and Right)
                    gsap.to(card, {
                        zIndex: 5 - stackPositionAbs,
                        x: (stackPositionAbs * 15) + '%', // Move Right
                        y: (ACTIVE_Y_BASE - (stackPositionAbs * 15)) + '%', // Move Up relative to base
                        z: -(stackPositionAbs * 150),
                        scale: 1,
                        ...animProps
                    });
                }
            });

            // 4. Fade In New Text
            gsap.fromTo(textContents[activeIndex], 
                { opacity: 0, zIndex: 2 }, // Start at opacity 0, higher zIndex for visible element
                {
                    opacity: 1,
                    duration: 0.5,
                    delay: 0.1, // Slight delay after old text fades out
                    ease: 'power2.inOut',
                    zIndex: 2 // Keep high zIndex
                }
            );
        }

        // Set Initial State
        function setInitialState() {
            // Set bar to first item
            gsap.set(activeBar, {
                top: navItems[0].offsetTop,
                height: navItems[0].offsetHeight
            });

            // Set initial card positions
            imageCards.forEach((card, index) => {
                const stackPosition = index - activeIndex;
                const stackPositionAbs = Math.abs(stackPosition);

                if (stackPosition === 0) {
                    gsap.set(card, {
                        zIndex: 10, 
                        x: '0%', 
                        y: ACTIVE_Y_BASE + '%', // Move to bottom
                        z: 0, 
                        rotate: '0deg', 
                        scale: 1
                    });
                } else {
                    gsap.set(card, {
                        zIndex: 5 - stackPositionAbs,
                        x: (stackPositionAbs * 15) + '%',
                        y: (ACTIVE_Y_BASE - (stackPositionAbs * 15)) + '%', // Move Up
                        z: -(stackPositionAbs * 150),
                        scale: 1
                    });
                }
            });

            // Set initial text content state (only first one visible)
            textContents.forEach((text, index) => {
                if (index === activeIndex) {
                    gsap.set(text, { opacity: 1, zIndex: 2 });
                } else {
                    gsap.set(text, { opacity: 0, zIndex: 1 });
                }
            });
        }

        // Add Event Listeners
        navItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                updateActiveState(index);
            });
        });

        // Initialize the component
        setInitialState();

        // Set first nav item as active with custom-green color
        navItems[0].classList.add('text-custom-green');

        // Set first nav item as active (already handled by setInitialState's logic setting activeIndex=0)
        // Ensure the initial class is set on the first item for the color
        navItems[0].classList.add('text-custom-green');
    });
</script>
{% endblock %}