{% extends 'mainapp/navbar_footer.html' %}
{% load static %}

{% block title %}Our Projects - EcoPath{% endblock %}

{% block extra_head %}
<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<style>
    /* Custom styles */
    .ecopath-card {
        will-change: flex;
    }

    .card-content {
        will-change: transform;
    }

    .heading,
    .description {
        will-change: opacity, max-width, max-height;
    }

    /* Hero Section Styles */
    .hero-slide {
        opacity: 0;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .text-shadow {
        text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.5);
    }

    .hero-dot {
        background-color: rgba(255, 255, 255, 0.3);
        transition: background-color 0.3s ease;
    }

    .hero-dot.active {
        background-color: rgba(255, 255, 255, 1);
    }

    .hero-nav-item-slot {
        display: inline-block;
    }

    .hero-nav-group {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        /* 24px */
        opacity: 0;
    }

    /* Carousel Styles */
    .carousel-slide {
        transition: opacity 0.5s ease-in-out;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    /* Hide scrollbar but keep functionality */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }

    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
</style>
<!-- <script>
    // Custom Tailwind configuration
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'custom-green': '#17411A',
                    'custom-yellow': '#F0ED2F',
                    'card-bg-green': '#A0DEA7'
                },
                fontFamily: {
                    'montserrat': ['Montserrat', 'sans-serif'],
                    'product-sans': ['Product Sans', 'sans-serif'],
                },
                fontSize: {
                    'sm': '14px', // 14px
                    'lg': '18px', // 18px
                    '5xl': '48px', // 48px
                }
            }
        }
    }
</script> -->
{% endblock %}

{% block content %}
<!-- Hero Carousel Section -->
<section class="relative h-screen w-full overflow-hidden pt-12">
    <!-- Slides Container -->
    <div id="carousel-slides" class="h-full w-full relative">
        <!-- Slide 1 -->
        <div class="carousel-slide absolute inset-0 w-full h-full" data-index="0"
            style="background-image: url('{% static 'images/Project 1 image.webp' %}');">
            <!-- <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
                <div class="text-center px-4 text-white">
                    <h1 class="text-4xl md:text-6xl lg:text-7xl font-product-sans font-black mb-6">Project One</h1>
                    <p class="text-xl md:text-2xl font-montserrat max-w-3xl mx-auto">Transforming urban infrastructure
                        with sustainable solutions</p>
                </div>
            </div> -->
        </div>
        <!-- Slide 2 -->
        <div class="carousel-slide absolute inset-0 w-full h-full opacity-0" data-index="1"
            style="background-image: url('{% static 'images/Project 2 image.webp' %}');">
        </div>
        <!-- Slide 3 -->
        <div class="carousel-slide absolute inset-0 w-full h-full opacity-0" data-index="2"
            style="background-image: url('{% static 'images/Project 3 image.webp' %}');">
        </div>
        <div class="carousel-slide absolute inset-0 w-full h-full opacity-0" data-index="3"
            style="background-image: url('{% static 'images/Project 4 image.webp' %}');">
        </div>
        <div class="carousel-slide absolute inset-0 w-full h-full opacity-0" data-index="4"
            style="background-image: url('{% static 'images/Project 5 image.webp' %}');">
        </div>
    </div>

    <!-- Navigation Arrows -->
    <button id="prev-btn"
        class="absolute left-4 md:left-8 top-1/2 -translate-y-1/2 z-10 bg-black/30 hover:bg-black/50 text-white p-3 rounded-full transition-all duration-300 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 md:h-10 md:w-10" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
    </button>
    <button id="next-btn"
        class="absolute right-4 md:right-8 top-1/2 -translate-y-1/2 z-10 bg-black/30 hover:bg-black/50 text-white p-3 rounded-full transition-all duration-300 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 md:h-10 md:w-10" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
    </button>

    <!-- Dots Navigation -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 z-10 flex space-x-3">
        <button
            class="dot-btn w-3 h-3 rounded-full bg-white hover:bg-white/80 transition-all duration-300 focus:outline-none"
            data-index="0"></button>
        <button
            class="dot-btn w-3 h-3 rounded-full bg-white/30 hover:bg-white/50 transition-all duration-300 focus:outline-none"
            data-index="1"></button>
        <button
            class="dot-btn w-3 h-3 rounded-full bg-white/30 hover:bg-white/50 transition-all duration-300 focus:outline-none"
            data-index="2"></button>
        <button
            class="dot-btn w-3 h-3 rounded-full bg-white/30 hover:bg-white/50 transition-all duration-300 focus:outline-none"
            data-index="3"></button>
        <button
            class="dot-btn w-3 h-3 rounded-full bg-white/30 hover:bg-white/50 transition-all duration-300 focus:outline-none"
            data-index="4"></button>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const slides = document.querySelectorAll('.carousel-slide');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const dotBtns = document.querySelectorAll('.dot-btn');

        let currentSlide = 0;
        const totalSlides = slides.length;
        let slideInterval;
        const slideDuration = 5000; // 5 seconds

        // Initialize first slide
        updateSlide(0);
        startSlideShow();

        // Navigation functions
        function goToSlide(index) {
            currentSlide = (index + totalSlides) % totalSlides;
            updateSlide(currentSlide);
            resetSlideShow();
        }

        function goToNext() {
            goToSlide(currentSlide + 1);
        }

        function goToPrev() {
            goToSlide(currentSlide - 1);
        }

        // Update slide visibility and active states
        function updateSlide(index) {
            // Update slides
            slides.forEach((slide, i) => {
                if (i === index) {
                    gsap.to(slide, { opacity: 1, duration: 0.5 });
                } else {
                    gsap.to(slide, { opacity: 0, duration: 0.5 });
                }
            });

            // Update dots
            dotBtns.forEach((dot, i) => {
                if (i === index) {
                    dot.classList.remove('bg-white/30', 'w-3');
                    dot.classList.add('bg-white', 'w-6');
                } else {
                    dot.classList.remove('bg-white', 'w-6');
                    dot.classList.add('bg-white/30', 'w-3');
                }
            });

            // Update current slide index
            currentSlide = index;
        }

        // Auto-play functionality
        function startSlideShow() {
            slideInterval = setInterval(goToNext, slideDuration);
        }

        function resetSlideShow() {
            clearInterval(slideInterval);
            startSlideShow();
        }

        // Event Listeners
        prevBtn.addEventListener('click', () => {
            goToPrev();
        });

        nextBtn.addEventListener('click', () => {
            goToNext();
        });

        dotBtns.forEach(dot => {
            dot.addEventListener('click', () => {
                const slideIndex = parseInt(dot.getAttribute('data-index'));
                goToSlide(slideIndex);
            });
        });

        // Pause on hover
        const carousel = document.querySelector('section');
        carousel.addEventListener('mouseenter', () => {
            clearInterval(slideInterval);
        });

        carousel.addEventListener('mouseleave', () => {
            resetSlideShow();
        });

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                goToPrev();
            } else if (e.key === 'ArrowRight') {
                goToNext();
            }
        });
    });
</script>

<!--Signature Projects-->
<section class="py-8 md:py-12 px-4 sm:px-6 lg:px-8">
    <h1 class="text-3xl md:text-5xl tracking-tight font-product-sans text-center text-custom-green py-8 mb-8">
        Our Signature Projects
    </h1>
    
    {% for project in signature_projects %}
    <div class="container mx-auto mb-16 last:mb-0">
        <div class="flex flex-col md:flex-row lg:mx-12 md:gap-12 items-center">
            
            {% if forloop.counter|divisibleby:2 %}
                <div class="w-full md:w-1/2 py-6 order-2 md:order-1">
                    <h2 class="text-2xl md:text-3xl lg:text-5xl font-product-sans text-custom-green md:leading-tight py-4">
                        {{ project.title }}
                    </h2>
                    <p class="font-montserrat text-lg text-gray-700 leading-relaxed mb-6">
                        {{ project.brief_description }}
                    </p>
                    <a href="{% url 'mainapp:project_detail' slug=project.slug %}" class="font-montserrat text-[#0C96EC] text-[1.2rem] inline-block hover:underline">
                        Explore Project <span>&rarr;</span>
                    </a>
                </div>

                <div class="w-full md:w-1/2 flex justify-center order-1 md:order-2">
                    {% if project.main_image %}
                    <img src="{{ project.main_image.image.url }}" alt="{{ project.main_image.alt_text }}"
                        class="w-full h-[350px] md:w-[500px] md:h-[600px] object-cover rounded-tr-[60px] rounded-bl-[60px] shadow-lg mb-8 md:mb-0">
                    {% endif %}
                </div>

            {% else %}
                <div class="w-full md:w-1/2 flex justify-center mb-0 md:mb-0">
                    {% if project.main_image %}
                    <img src="{{ project.main_image.image.url }}" alt="{{ project.main_image.alt_text }}"
                        class="w-full h-[350px] md:w-[500px] md:h-[600px] object-cover rounded-tr-[60px] rounded-bl-[60px] shadow-lg mb-8 md:mb-0">
                    {% endif %}
                </div>

                <div class="w-full md:w-1/2 py-6 items-start">
                    <h2 class="text-3xl md:text-4xl lg:text-5xl font-product-sans text-custom-green md:leading-tight py-4">
                        {{ project.title }}
                    </h2>
                    <p class="font-montserrat text-lg text-gray-700 leading-tight mb-6">
                        {{ project.brief_description }}
                    </p>
                    <a href="{% url 'mainapp:project_detail' slug=project.slug %}"
                        class="font-montserrat text-[#0C96EC] text-[1.2rem] inline-block hover:underline">
                        Explore Project <span>&rarr;</span>
                    </a>
                </div>
            {% endif %}
            
        </div>
    </div>
    {% empty %}
    <div class="container mx-auto">
        <p class="text-center font-montserrat text-gray-600">
            Projects coming soon.
        </p>
    </div>
    {% endfor %}
</section>

<!-- Projects Grid Section -->
<section class="py-12 md:py-20 px-4 sm:px-6 lg:px-8 bg-white">
    <div class="container mx-auto">
        <h2 class="text-3xl md:text-3xl lg:text-5xl font-product-sans font-black text-custom-green mb-8">
            Project Archive
        </h2>

        <!-- Scrollable Cards Container -->
        <div class="relative">
            <div class="flex overflow-x-auto pb-6 -mx-2" id="projects-scroll-container">
                {% for project in archive_projects %}
                <div class="px-2 flex-none w-[75%] md:w-1/4">
                    <a href="{% url 'mainapp:project_detail' slug=project.slug %}"
                        class="bg-white overflow-hidden h-full flex flex-col">
                        <div class="h-[20rem] bg-gray-200 overflow-hidden">
                            {% if project.main_image %}
                            <img src="{{ project.main_image.image.url }}" alt="{{ project.main_image.alt_text }}"
                                class="w-full h-full object-cover">
                            {% endif %}
                        </div>
                        <div class="pt-3 flex-grow">
                            <h3 class="font-product-sans font-black text-2xl text-black mb-2">{{ project.title }}</h3>
                        </div>
                    </a>
                </div>
                {% empty %}
                <div class="px-2 flex-none w-full">
                    <div class="bg-white overflow-hidden h-full flex flex-col items-center justify-center py-8">
                        <p class="font-montserrat text-gray-600">No archived projects available yet.</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endblock %}